"use strict";(()=>{var e={};e.id=3326,e.ids=[3326],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{e.exports=require("punycode")},27910:e=>{e.exports=require("stream")},28423:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>c,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(59743),i=t(23112),n=t(2567),u=t(85454),a=t(78286),p=t(23079);async function d(e,{params:r}){try{let e=await (0,a.createClient)(),t=new p.A,{data:{user:s}}=await e.auth.getUser();if(!s)return u.NextResponse.json({error:"Unauthorized"},{status:401});let{data:o,error:i}=await e.from("tutoring_sessions").select("*").eq("id",r.id).single();if(i||!o)return u.NextResponse.json({error:"Session not found"},{status:404});if(o.tutor_id!==s.id&&o.student_id!==s.id)return u.NextResponse.json({error:"Not authorized to complete this session"},{status:403});let{error:n}=await e.from("tutoring_sessions").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",r.id);if(n)return console.error("Error updating session:",n),u.NextResponse.json({error:"Failed to complete session"},{status:500});let d=await t.createHoursFromTutoringSession({session_id:r.id,tutor_id:o.tutor_id,student_id:o.student_id,subject:o.subject,topic:o.topic,duration:o.duration,session_date:o.scheduled_date});return d.success||console.error("Error creating volunteer hours:",d.error),u.NextResponse.json({success:!0,message:"Session completed successfully",volunteerHours:d.success?d.data:null})}catch(e){return console.error("Error completing session:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/tutoring/sessions/[id]/complete/route",pathname:"/api/tutoring/sessions/[id]/complete",filename:"route",bundlePath:"app/api/tutoring/sessions/[id]/complete/route"},resolvedPagePath:"/Users/yatishgrandhe/Downloads/Stem-Spark-main/app/api/tutoring/sessions/[id]/complete/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:x,serverHooks:m}=c;function g(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:x})}},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{e.exports=require("tls")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{e.exports=require("zlib")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")},91645:e=>{e.exports=require("net")},94735:e=>{e.exports=require("events")}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1703,7893,9600,6754],()=>t(28423));module.exports=s})();