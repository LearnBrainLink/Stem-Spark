(()=>{var e={};e.id=8982,e.ids=[1725,8982],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7261:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>c,serverHooks:()=>_,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>l,POST:()=>d});var o=r(59743),n=r(23112),i=r(2567),u=r(85454),a=r(78286);async function l(e){try{let e,t=await (0,a.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)return u.NextResponse.json({error:"Unauthorized"},{status:401});let{data:s}=await t.from("profiles").select("role").eq("id",r.id).single();if(!s)return u.NextResponse.json({error:"Profile not found"},{status:404});e="intern"===s.role?t.from("tutoring_sessions").select(`
          *,
          tutor:profiles!tutoring_sessions_tutor_id_fkey(full_name),
          student:profiles!tutoring_sessions_student_id_fkey(full_name)
        `).eq("tutor_id",r.id):t.from("tutoring_sessions").select(`
          *,
          tutor:profiles!tutoring_sessions_tutor_id_fkey(full_name),
          student:profiles!tutoring_sessions_student_id_fkey(full_name)
        `).eq("student_id",r.id);let{data:o,error:n}=await e.order("scheduled_date",{ascending:!0});if(n)return console.error("Error fetching sessions:",n),u.NextResponse.json({error:"Failed to fetch sessions"},{status:500});let i=o?.map(e=>({...e,tutor_name:e.tutor?.full_name||"Unknown Tutor",student_name:e.student?.full_name||"Unknown Student"}))||[];return u.NextResponse.json({success:!0,sessions:i})}catch(e){return console.error("Error in sessions API:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let t=await (0,a.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)return u.NextResponse.json({error:"Unauthorized"},{status:401});let{data:s}=await t.from("profiles").select("role").eq("id",r.id).single();if(!s||"student"!==s.role)return u.NextResponse.json({error:"Only students can book tutoring sessions"},{status:403});let{tutor_id:o,subject:n,topic:i,scheduled_date:l,scheduled_time:d,duration:c,notes:p}=await e.json();if(!o||!n||!i||!l||!d)return u.NextResponse.json({error:"Missing required fields"},{status:400});let{data:f}=await t.from("profiles").select("role").eq("id",o).eq("role","intern").single();if(!f)return u.NextResponse.json({error:"Tutor not found or not available"},{status:404});let{data:_,error:x}=await t.from("tutoring_sessions").insert({tutor_id:o,student_id:r.id,subject:n,topic:i,scheduled_date:l,scheduled_time:d,duration:c||60,notes:p,status:"scheduled",created_at:new Date().toISOString()}).select().single();if(x)return console.error("Error creating session:",x),u.NextResponse.json({error:"Failed to create session"},{status:500});return u.NextResponse.json({success:!0,session:_})}catch(e){return console.error("Error creating session:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/tutoring/sessions/route",pathname:"/api/tutoring/sessions",filename:"route",bundlePath:"app/api/tutoring/sessions/route"},resolvedPagePath:"/Users/yatishgrandhe/Downloads/Stem-Spark-main/app/api/tutoring/sessions/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:f,serverHooks:_}=c;function x(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:f})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},28187:()=>{},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},50253:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56836:()=>{},60931:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=60931,e.exports=t},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78286:(e,t,r)=>{"use strict";r.d(t,{createClient:()=>n});var s=r(72831),o=r(62519);function n(){let e=(0,o.UL)();return(0,s.Ri)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:s})=>e.set(t,r,s))}catch{}}}})}},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81331:()=>{},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1703,7893,9600],()=>r(7261));module.exports=s})();